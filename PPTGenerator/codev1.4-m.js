function PPTGenerator(){return{oResultSet:{},iDateIndex:0,iTimeIndex:0,iAppServerIndex:0,iMeasuresIndex:0,aDataSet:[],init:function(){this.oResultSet={},this.iDateIndex=0,this.iTimeIndex=0,this.iAppServerIndex=0,this.iMeasuresIndex=0,this.aDataSet=[]},getTextControlReference:function(){return document.querySelector("#dataSet")},clear:function(){this.getTextControlReference().value=""},setDataPayload:function(){let e=this.getTextControlReference().value;if(""===e.trim())throw new Error("- No input -");this.aDataSet=e.split(/\r\n|\n|\r/)},setMeasuresIndex:function(){for(this.iMeasuresIndex=0;this.iMeasuresIndex<this.aDataSet.length&&(-1===this.aDataSet[this.iMeasuresIndex].indexOf("AS Instance")&&-1===this.aDataSet[this.iMeasuresIndex].indexOf("Server Name")&&-1===this.aDataSet[this.iMeasuresIndex].indexOf("Act. WPs"));this.iMeasuresIndex++);if(this.iMeasuresIndex===this.aDataSet.length)throw new Error("- Invalid input; no AS Instance or Server Name found in dataset -")},buildEmptyResultSet:function(){const e=this.aDataSet[this.iMeasuresIndex].split("|").map(e=>e.trim());if(e.length<3)throw new Error("- Invalid input; Measures parsing failed - ");for(let t=0;t<e.length;t++){const i=e[t];i&&""!==i&&("date"==i.toLowerCase()&&0===this.iDateIndex?this.iDateIndex=t:"time"==i.toLowerCase()&&0===this.iTimeIndex?this.iTimeIndex=t:"as instance"==i.toLowerCase()&&0===this.iAppServerIndex?this.iAppServerIndex=t:"server name"==i.toLowerCase()&&0===this.iAppServerIndex?this.iAppServerIndex=t:this.oResultSet[i]?this.oResultSet[i+"-1"]={index:t}:this.oResultSet[i]={index:t})}if(0!==this.iTimeIndex&&0===this.iAppServerIndex&&(this.iAppServerIndex=this.iTimeIndex),0===this.iTimeIndex||0===this.iAppServerIndex)throw new Error("- Cannot find index for Time or App Server in DataSet -")},fillResultSet:function(){let e,t=Object.keys(this.oResultSet);if(this.iMeasuresIndex+2>this.aDataSet.length)throw new Error("- No lines after the measures -");for(let i=this.iMeasuresIndex+2;i<this.aDataSet.length;i++)if(!((e=this.aDataSet[i].split("|")).length<2)&&"Global Data"!==e[this.iAppServerIndex].trim())for(let i=0;i<t.length;i++){let s=this.oResultSet[t[i]],n=this.iTimeIndex===this.iAppServerIndex?"App Server":e[this.iAppServerIndex];s[n]||(s[n]={TimeStamps:[],Values:[]});let r=s[n];if(r.TimeStamps.push(e[this.iTimeIndex]),sCurrentLineValue=e[s.index],sCurrentLineValue=parseInt(sCurrentLineValue.replace(/,/g,"").replace(/\./g,"")),isNaN(sCurrentLineValue))throw new Error("Encountred a value that is not a number");r.Values.push(sCurrentLineValue)}},processDataSet:function(){this.init(),this.updateButton("Validating Input...",!0),this.setDataPayload(),this.setMeasuresIndex(),this.buildEmptyResultSet(),this.fillResultSet()},beginProcessing:function(){try{this.processDataSet(),this.buildPPT()}catch(e){throw this.updateButton("Generate Report",!1),this.updateInformationProvider(e),e}},buildPPT:function(){let e=new PptxGenJS,t=Object.keys(this.oResultSet);-1!==t.indexOf("Sessions")&&(t=t.filter(e=>"Sessions"!==e),t=["Sessions",...t]),-1!==t.indexOf("Logins")&&(t=t.filter(e=>"Logins"!==e),t=["Logins",...t]);for(let s=0;s<t.length;s++){let n,r=this.oResultSet[t[s]];if(!r.index)continue;let a=e.addSlide();a.addText(this.getFriendlyText(t[s]),{x:.5,y:.7,w:8,fontSize:24}),a.addText("--- Add Analysis Here ---",{x:.5,y:4.25,w:8,h:.5,isTextBox:!0,line:{pt:"2",color:"A9A9A9"},fontSize:20});let o=Object.keys(r),u=[];for(let e=0;e<o.length;e++){let t=o[e],i=r[t];if(i.TimeStamps&&i.Values){const e=i.TimeStamps[0],s=i.TimeStamps[i.TimeStamps.length-1];if(3!==e.split(":").length||3!==s.split(":").length)throw new Error("Calculated timestamps are invalid!");const r=new Date,a=new Date;r.setHours(e.split(":")[0]),r.setMinutes(e.split(":")[1]),r.setSeconds(e.split(":")[2]),a.setHours(s.split(":")[0]),a.setMinutes(s.split(":")[1]),a.setSeconds(s.split(":")[2]),r>a&&(i.TimeStamps.reverse(),i.Values.reverse());let o=Math.min(...i.Values);(!n||o<n)&&(n=o),u.push({name:t,labels:i.TimeStamps,values:i.Values})}}var i={x:.5,y:1,w:8,h:3,lineSize:1,lineDataSymbol:"none",lineSmooth:!0,showLegend:!0,legendPos:"r",catGridLine:{color:"D8D8D8",style:"none",size:1},valGridLine:{color:"D8D8D8",style:"dash",size:1}};n<10&&(i.valAxisMinVal=0),a.addChart(e.ChartType.line,u,i)}this.updateButton("Generating file...",!0);var s=this;e.writeFile("SDF SMON Report").then(function(e){s.updateButton("Generate Report",!1),s.updateInformationProvider("Saved! File Name: "+e,!0)})},updateButton:function(e,t){let i=document.querySelector("#reportGenerateButton");i.textContent=e,i.disabled=t},updateInformationProvider:function(e,t){document.querySelector("#successMessageHolder").innerText=e,t&&setTimeout(function(){document.querySelector("#successMessageHolder").innerText=""},4e3)},getFriendlyText:function(e){switch(e){case"Act. WPs":return"Number of Active Work Processes";case"Dia.WPs":return"Number of Active Dialog Work Processes";case"RFC WPs":return"Number of available WPs for RFCs";case"CPU Usr":return"CPU Utilization (User)";case"CPU Sys":return"CPU Utilization (System)";case"CPU Idle":return"CPU Utilization (Idle)";case"CPU.":return"CPUs Consumed";case"Ava.":return"Available CPUs";case"Rea.":return"Ready Time in %";case"Ste.":return"Steal Time in Seconds";case"Paging in":return"Paging in (% of RAM per hour)";case"Paging out":return"Paging out  (% of RAM per hour)";case"Free Mem.":return"Free Memory in % of RAM";case"FreeMem":return"Free Memory (MB)";case"Free(+FS)":return"Free Memory MB (incl. Filesystem Cache)";case"EM alloc.":return"Allocated Extended Memory in MB";case"EM attach.":return"Attached Extended Memory in MB";case"Heap Memor":return"Heap Memory in MB";case"Pri.":return"Priv Modes";case"Dia.":return"Dialog Queue Length";case"Ave.":return"Average Load last 20s";case"Ave.-1":return"Average Load last 60s";case"Upd.":return"Update Queue Length";case"Enq.":return"Enqueue Queue Length";case"Logins":return"Number of logins";case"Sessions":return"Number of sessions";case"Em global":return"Extended Memory Global";default:return e}}}}